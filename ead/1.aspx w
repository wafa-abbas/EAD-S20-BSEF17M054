Imports System
Imports System.Web.UI.WebControls
Imports System.Net.Mail

Public Class SendMail
    Inherits System.Web.UI.Page
    
    Protected Sub btn_SendMessage_Click(ByVal sender As Object, ByVal e As EventArgs)

        Dim smtpClient As SmtpClient = New SmtpClient("domain.a2hosted.com", 25)

        smtpClient.Credentials = New System.Net.NetworkCredential("user@example.com", "password")
        smtpClient.DeliveryMethod = SmtpDeliveryMethod.Network

        Dim mailMessage As MailMessage = New MailMessage(txtFrom.Text, txtTo.Text)
        mailMessage.Subject = txtSubject.Text
        mailMessage.Body = txtBody.Text

        Try 
            smtpClient.Send(mailMessage)
            Label1.Text = "Message sent"
        Catch ex As Exception
            Label1.Text = ex.ToString
        End Try

    End Sub
End Class